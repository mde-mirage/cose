<?xml version="1.0" encoding="UTF-8"?>
<topology>
 <hosts>
  <host name="C1" id="C1" type="Firewall" IP_address="255.255.255.255"></host>
  <host name="C2" id="C2" type="Firewall" IP_address="255.255.255.255"></host>
  <host name="C3" id="C3" type="NIDS" IP_address="255.255.255.255"></host>
  <host name="C4" id="C4" type="NIDS" IP_address="255.255.255.255"></host>
  <host name="C5" id="C5" type="Firewall" IP_address="255.255.255.255"></host>
  <host name="C6" id="C6" type="Firewall" IP_address="255.255.255.255"></host>
 </hosts>
 <rules>
  <fw name="C1" type="Firewall">
   <rule>
    <condition>
     <subcondition>
      <s>1.0.1.0,1.0.1.255</s>
      <d>2.0.12.0,2.0.12.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>accept</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>1.0.2.0,1.0.2.255</s>
      <d>2.0.12.0,2.0.12.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>accept</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>1.0.3.20,1.0.3.33</s>
      <d>1.0.1.20,1.0.1.30</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>accept</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>1.0.3.60,1.0.3.80</s>
      <d>1.0.1.20,1.0.1.30</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>accept</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>2.0.11.0,2.0.11.30</s>
      <d>1.0.2.10,1.0.2.30</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>accept</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>2.0.9.10,2.0.9.20</s>
      <d>1.0.1.0,1.0.1.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>accept</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>2.0.11.0,2.0.11.255</s>
      <d>1.0.1.10,1.0.1.12</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>accept</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
  <policy>close</policy>
  </fw>
  <fw name="C2" type="Firewall">
   <rule>
    <condition>
     <subcondition>
      <s>2.0.9.15,2.0.9.17</s>
      <d>1.0.1.0,1.0.1.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>accept</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>2.0.10.0,2.0.10.70</s>
      <d>2.0.7.0,2.0.7.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>accept</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>2.0.10.0,2.0.10.70</s>
      <d>1.0.2.0,1.0.2.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>accept</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>2.0.11.0,2.0.11.255</s>
      <d>1.0.1.0,1.0.1.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>accept</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>2.0.10.0,2.0.10.70</s>
      <d>2.0.4.0,2.0.4.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>accept</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>1.0.1.0,1.0.2.255</s>
      <d>2.0.12.0,2.0.12.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>accept</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
  <policy>close</policy>
  </fw>
  <fw name="C3" type="NIDS">
   <rule>
    <condition>
     <subcondition>
      <s>1.0.3.20,1.0.3.33</s>
      <d>2.0.1.20,2.0.1.30</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>accept</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc>msg: "SSH allowed activity"; content:"SSH-"; classtype:allowed-activity;</nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>1.0.3.60,1.0.3.80</s>
      <d>2.0.1.20,2.0.1.30</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>accept</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc>msg: "SSH allowed activity"; content:"SSH-"; classtype:allowed-activity;</nids_misc>
   </rule>
  <policy>close</policy>
  </fw>
  <fw name="C4" type="NIDS">
   <rule>
    <condition>
     <subcondition>
      <s>2.0.10.10,2.0.10.10</s>
      <d>2.0.4.0,2.0.4.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,1</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>deny</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc>msg:"WEB-ATTACKS /usr/bin/id command attempt"; flow:to_server,established; content:"/usr/bin/id"; nocase; classtype:web-application-attack; sid:1332; rev:5;</nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>2.0.10.60,2.0.10.80</s>
      <d>2.0.4.0,2.0.4.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>deny</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc>msg:"WEB-ATTACKS /usr/bin/id command attempt"; flow:to_server,established; content:"/usr/bin/id"; nocase; classtype:web-application-attack; sid:1332; rev:5;</nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>1.0.4.15,1.0.4.30</s>
      <d>2.0.3.0,2.0.3.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>deny</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc>msg:"WEB-ATTACKS /usr/bin/id command attempt"; flow:to_server,established; content:"/usr/bin/id"; nocase; classtype:web-application-attack; sid:1332; rev:5;</nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>1.0.5.0,1.0.5.255</s>
      <d>2.0.3.0,2.0.3.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>deny</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc>msg:"WEB-ATTACKS /usr/bin/id command attempt"; flow:to_server,established; content:"/usr/bin/id"; nocase; classtype:web-application-attack; sid:1332; rev:5;</nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>1.0.3.18,1.0.3.20</s>
      <d>2.0.5.0,2.0.5.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>deny</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc>msg:"WEB-ATTACKS /usr/bin/id command attempt"; flow:to_server,established; content:"/usr/bin/id"; nocase; classtype:web-application-attack; sid:1332; rev:5;</nids_misc>
   </rule>
  <policy>open</policy>
  </fw>
  <fw name="C5" type="Firewall">
   <rule>
    <condition>
     <subcondition>
      <s>2.0.10.10,2.0.10.10</s>
      <d>2.0.7.0,2.0.7.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,1</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>deny</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>2.0.10.60,2.0.10.80</s>
      <d>2.0.7.0,2.0.7.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>deny</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>1.0.4.15,1.0.4.30</s>
      <d>2.0.6.0,2.0.6.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>deny</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>1.0.5.0,1.0.5.255</s>
      <d>2.0.6.0,2.0.6.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>deny</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>1.0.3.18,1.0.3.20</s>
      <d>2.0.8.0,2.0.8.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>deny</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
  <policy>open</policy>
  </fw>
  <fw name="C6" type="Firewall">
   <rule>
    <condition>
     <subcondition>
      <s>1.0.4.0,1.0.4.255</s>
      <d>2.0.6.0,2.0.6.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>deny</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>1.0.5.18,1.0.5.20</s>
      <d>2.0.6.0,2.0.6.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>deny</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>1.0.3.10,1.0.3.20</s>
      <d>1.0.1.0,1.0.1.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>deny</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>1.0.3.21,1.0.3.70</s>
      <d>1.0.1.0,1.0.1.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>deny</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>1.0.4.0,1.0.4.255</s>
      <d>2.0.3.0,2.0.3.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>deny</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>1.0.5.18,1.0.5.20</s>
      <d>2.0.3.0,2.0.3.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>deny</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>1.0.3.10,1.0.3.23</s>
      <d>2.0.1.0,2.0.1.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>deny</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
   <rule>
    <condition>
     <subcondition>
      <s>1.0.3.24,1.0.3.60</s>
      <d>2.0.1.0,2.0.1.255</d>
      <sP>1,65535</sP>
      <dP>1,65535</dP>
      <p>1,2</p>
     </subcondition>
     <subcondition>
     </subcondition>
    </condition>
    <decision>deny</decision>
    <shadowing>false</shadowing>
    <redundancy>false</redundancy>
    <nids_misc></nids_misc>
   </rule>
  <policy>open</policy>
  </fw>
 </rules>
 <zones>
  <zone name="E1" id="ZE1">
   <included>
    1.0.1.0/24,1.0.2.0/24
   </included>
   <excluded>
   </excluded>
  </zone>
  <zone name="E2" id="ZE2">
   <included>
    1.0.3.0/24,1.0.4.0/24,1.0.5.0/24
   </included>
   <excluded>
   </excluded>
  </zone>
  <zone name="P1" id="ZP1">
   <included>
    2.0.1.0/24,2.0.2.0/24
   </included>
   <excluded>
   </excluded>
  </zone>
  <zone name="P2" id="ZP2">
   <included>
    2.0.3.0/24,2.0.4.0/24,2.0.5.0/24
   </included>
   <excluded>
   </excluded>
  </zone>
  <zone name="P3" id="ZP3">
   <included>
    2.0.6.0/24,2.0.7.0/24,2.0.8.0/24
   </included>
   <excluded>
   </excluded>
  </zone>
  <zone name="P4" id="ZP4">
   <included>
    2.0.9.0/24,2.0.10.0/24,2.0.11.0/24
   </included>
   <excluded>
   </excluded>
  </zone>
  <zone name="P5" id="ZP5">
   <included>
    2.0.12.0/24
   </included>
   <excluded>
   </excluded>
  </zone>
  <zone name="bnorth" id="Zbnorth">
   <included>
    FF:FF:FF:FF:FF:FF/0
   </included>
   <excluded>
   </excluded>
  </zone>
  <zone name="bwest" id="Zbwest">
   <included>
    FF:FF:FF:FF:FF:FF/0
   </included>
   <excluded>
   </excluded>
  </zone>
  <zone name="beast1" id="Zbeast1">
   <included>
    FF:FF:FF:FF:FF:FF/0
   </included>
   <excluded>
   </excluded>
  </zone>
  <zone name="beast2" id="Zbeast2">
   <included>
    FF:FF:FF:FF:FF:FF/0
   </included>
   <excluded>
   </excluded>
  </zone>
  <zone name="bsouth1" id="Zbsouth1">
   <included>
    FF:FF:FF:FF:FF:FF/0
   </included>
   <excluded>
   </excluded>
  </zone>
  <zone name="bsouth2" id="Zbsouth2">
   <included>
    FF:FF:FF:FF:FF:FF/0
   </included>
   <excluded>
   </excluded>
  </zone>
 </zones>
 <connections>
  <adjacent host_id="C1" zone_id="Zbnorth">
   C1,Zbnorth
  </adjacent>
  <adjacent host_id="C1" zone_id="ZE1">
   C1,ZE1
  </adjacent>
  <adjacent host_id="C1" zone_id="Zbwest">
   C1,Zbwest
  </adjacent>
  <adjacent host_id="C3" zone_id="ZP1">
   C3,ZP1
  </adjacent>
  <adjacent host_id="C3" zone_id="Zbnorth">
   C3,Zbnorth
  </adjacent>
  <adjacent host_id="C2" zone_id="Zbwest">
   C2,Zbwest
  </adjacent>
  <adjacent host_id="C2" zone_id="ZP5">
   C2,ZP5
  </adjacent>
  <adjacent host_id="C2" zone_id="ZP4">
   C2,ZP4
  </adjacent>
  <adjacent host_id="C2" zone_id="Zbsouth1">
   C2,Zbsouth1
  </adjacent>
  <adjacent host_id="C2" zone_id="Zbsouth2">
   C2,Zbsouth2
  </adjacent>
  <adjacent host_id="C6" zone_id="Zbnorth">
   C6,Zbnorth
  </adjacent>
  <adjacent host_id="C6" zone_id="ZE2">
   C6,ZE2
  </adjacent>
  <adjacent host_id="C6" zone_id="Zbeast1">
   C6,Zbeast1
  </adjacent>
  <adjacent host_id="C6" zone_id="Zbeast2">
   C6,Zbeast2
  </adjacent>
  <adjacent host_id="C6" zone_id="Zbsouth2">
   C6,Zbsouth2
  </adjacent>
  <adjacent host_id="C4" zone_id="Zbeast1">
   C4,Zbeast1
  </adjacent>
  <adjacent host_id="C4" zone_id="Zbwest">
   C4,Zbwest
  </adjacent>
  <adjacent host_id="C4" zone_id="ZP2">
   C4,ZP2
  </adjacent>
  <adjacent host_id="C5" zone_id="ZP3">
   C5,ZP3
  </adjacent>
  <adjacent host_id="C5" zone_id="Zbeast2">
   C5,Zbeast2
  </adjacent>
  <adjacent host_id="C5" zone_id="Zbsouth1">
   C5,Zbsouth1
  </adjacent>
 </connections>
</topology>
